---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import ErrorDemo from '../components/ErrorDemo.tsx';

const theme = Astro.cookies.get('theme')?.value || 'dark';
const textColor = theme === 'dark' ? 'text-primary' : 'text-primary';
---

<Layout title="Sentry Error Prediction Demo - Sergiy Dybskiy">
  <div class="!visible transition-opacity duration-150 bg-background text-foreground !opacity-100" id="v0-container" style="visibility:hidden;opacity:0">
    <div class="min-h-screen font-mono p-4 flex items-center justify-center transition-colors duration-0" style="font-size: 14px;">
      <main class="max-w-[900px] w-full">
        <Header name="sentry error prediction demo" location="powered by sentry ai" />

        <section class="mb-8" style="opacity: 1; will-change: opacity;">
          <div class="flex items-center mb-4">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="mr-2">
              <path d="M12 2L2 22h20L12 2zm0 3.5L19.5 20h-15L12 5.5z"/>
              <path d="M11 14h2v2h-2v-2zm0-6h2v4h-2V8z"/>
            </svg>
            <h1 class={`${textColor} text-xl font-semibold`}>Error Prediction Showcase</h1>
          </div>
          <p class={`${textColor} mb-4`}>
            This demo showcases various error-prone code patterns that Sentry's AI should be able to predict and prevent. 
            Each pattern represents a common source of runtime errors in JavaScript/TypeScript applications.
          </p>
        </section>

        <section class="mb-8">
          <ErrorDemo client:load />
        </section>

        <section class="mb-8" style="opacity: 1; will-change: opacity;">
          <h2 class="font-semibold mb-3">About Sentry Error Prediction</h2>
          <div class="space-y-3 text-sm">
            <p class={textColor}>
              <strong>Sentry's AI-powered error prediction</strong> analyzes your code patterns and historical error data 
              to predict potential issues before they occur in production.
            </p>
            <p class={textColor}>
              The system can identify patterns like null pointer exceptions, type mismatches, async/await issues, 
              array bounds errors, and other common JavaScript/TypeScript pitfalls.
            </p>
            <p class={textColor}>
              By catching these patterns early, teams can fix issues before they impact users, 
              reducing downtime and improving overall application reliability.
            </p>
          </div>
        </section>

        <section class="mb-8" style="opacity: 1; will-change: opacity;">
          <h2 class="font-semibold mb-3">Error Patterns Demonstrated</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
            <div class="space-y-2">
              <div class="border border-red-500 p-3 rounded">
                <h3 class="font-medium text-red-400">Null Pointer Access</h3>
                <p class="text-xs text-gray-500">Accessing properties on potentially null objects</p>
              </div>
              <div class="border border-orange-500 p-3 rounded">
                <h3 class="font-medium text-orange-400">Array Index Errors</h3>
                <p class="text-xs text-gray-500">Accessing array elements without bounds checking</p>
              </div>
              <div class="border border-yellow-500 p-3 rounded">
                <h3 class="font-medium text-yellow-400">Nested Object Access</h3>
                <p class="text-xs text-gray-500">Unsafe deep property access without optional chaining</p>
              </div>
              <div class="border border-green-500 p-3 rounded">
                <h3 class="font-medium text-green-400">Unhandled Async Errors</h3>
                <p class="text-xs text-gray-500">Missing error handling in async/await operations</p>
              </div>
            </div>
            <div class="space-y-2">
              <div class="border border-blue-500 p-3 rounded">
                <h3 class="font-medium text-blue-400">Type Coercion Issues</h3>
                <p class="text-xs text-gray-500">Implicit type conversions leading to unexpected results</p>
              </div>
              <div class="border border-purple-500 p-3 rounded">
                <h3 class="font-medium text-purple-400">Division by Zero</h3>
                <p class="text-xs text-gray-500">Mathematical operations without validation</p>
              </div>
              <div class="border border-pink-500 p-3 rounded">
                <h3 class="font-medium text-pink-400">String Operations on Undefined</h3>
                <p class="text-xs text-gray-500">String methods called on potentially undefined values</p>
              </div>
              <div class="border border-indigo-500 p-3 rounded">
                <h3 class="font-medium text-indigo-400">Race Conditions</h3>
                <p class="text-xs text-gray-500">State updates that could lead to inconsistent behavior</p>
              </div>
            </div>
          </div>
        </section>

        <section class="mb-8" style="opacity: 1; will-change: opacity;">
          <div class="bg-sentry-bg p-4 rounded border border-purple-500">
            <h3 class="font-semibold text-purple-400 mb-2">ðŸš€ Try It Out</h3>
            <p class="text-sm text-gray-300">
              Click the buttons above to trigger various error scenarios. In a real application with Sentry configured, 
              these patterns would be detected by the AI before they cause issues in production.
            </p>
            <p class="text-xs text-gray-400 mt-2">
              Learn more: <a href="https://docs.sentry.io/product/ai-in-sentry/sentry-prevent-ai/" target="_blank" class="text-purple-400 hover:underline">
                Sentry Error Prediction Documentation
              </a>
            </p>
          </div>
        </section>

        <Footer />
      </main>
    </div>
  </div>
</Layout>

<style>
  .bg-sentry-bg {
    background-color: rgba(43, 27, 61, 0.5);
  }
</style>